{% extends "base.html" %}
{% block contenido %}

<!-- MenÃº de navegaciÃ³n -->
<nav class="navbar-nav-horizontal mb-4">
    <a href="{% url 'pedidos_home' %}" class="nav-item">ğŸ  Inicio</a>
    <a href="{% url 'posibles_clientes' %}" class="nav-item">ğŸ‘¥ Posibles clientes</a>
    <a href="{% url 'gastos' %}" class="nav-item">ğŸ’° Gastos</a>
    <a href="{% url 'resumen' %}" class="nav-item">ğŸ“Š Resumen</a>
    <a href="{% url 'configuracion' %}" class="nav-item">âš™ï¸ ConfiguraciÃ³n</a>
</nav>

<h2>ğŸ“… Agenda</h2>

<button type="button" class="btn btn-primary mb-4" onclick="document.getElementById('formulario').style.display='block'">â• Nueva cita</button>

<div id="formulario" class="card-custom mb-4" style="display:none;">
    <h5 class="section-title mb-3">ğŸ“ Nueva cita</h5>
    <form method="POST" action="{% url 'agenda_guardar' %}">
        {% csrf_token %}
        
        <input type="hidden" name="cita_id" value="">
        
        <div class="row mb-3">
            <div class="col-md-6">
                <label>Fecha *</label>
                <input type="date" name="Fecha" class="form-control" required>
            </div>
            <div class="col-md-6">
                <label>Hora *</label>
                <input type="time" name="Hora" class="form-control" required>
            </div>
        </div>
        
        <div class="row mb-3">
            <div class="col-md-6">
                <label>Cliente *</label>
                <input type="text" name="Cliente" class="form-control" placeholder="Nombre del cliente" required>
            </div>
            <div class="col-md-6">
                <label>TelÃ©fono *</label>
                <input type="tel" name="Telefono" class="form-control" placeholder="TelÃ©fono" required>
            </div>
        </div>
        
        <div class="row mb-3">
            <div class="col-md-6">
                <label>Tipo *</label>
                <select name="Tipo" class="form-control" required>
                    <option value="">â€” Seleccionar â€”</option>
                    <option value="Nuevo cliente">Nuevo cliente</option>
                    <option value="Cliente existente">Cliente existente</option>
                    <option value="Seguimiento">Seguimiento</option>
                    <option value="ReuniÃ³n">ReuniÃ³n</option>
                </select>
            </div>
            <div class="col-md-6">
                <label>Club</label>
                <input type="text" name="Club" class="form-control" placeholder="Nombre del club">
            </div>
        </div>
        
        <div class="mb-3">
            <label>Notas</label>
            <textarea name="Notas" class="form-control" rows="3" placeholder="Detalles de la cita"></textarea>
        </div>
        
        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary">ğŸ’¾ Guardar</button>
            <button type="button" class="btn btn-secondary" onclick="document.getElementById('formulario').style.display='none'">Cancelar</button>
        </div>
    </form>
</div>

{% if citas %}
<div class="card-custom mb-4">
    <h5 class="section-title mb-3">ğŸ“‹ Citas ({{ citas|length }})</h5>
    <table class="table-home table table-striped">
        <thead>
            <tr>
                <th>Fecha</th>
                <th>Hora</th>
                <th>Cliente</th>
                <th>TelÃ©fono</th>
                <th>Club</th>
                <th>Tipo</th>
                <th>Notas</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for c in citas %}
            <tr>
                <td>{{ c.Fecha|default:"â€”" }}</td>
                <td>{{ c.Hora|default:"â€”" }}</td>
                <td>{{ c.Cliente|default:"â€”" }}</td>
                <td>{{ c.Telefono|default:"â€”" }}</td>
                <td>{{ c.Club|default:"â€”" }}</td>
                <td>{{ c.Tipo|default:"â€”" }}</td>
                <td>{{ c.Notas|default:"â€”" }}</td>
                <td>
                    <a href="{% url 'agenda_eliminar' c.ID %}" class="btn btn-sm btn-danger" onclick="return confirm('Â¿Eliminar?')">ğŸ—‘ï¸</a>
                </td>
            </tr>
            {% endfor %}  <!-- âœ… Â¡CORREGIDO! Tag endfor aÃ±adido -->
        </tbody>
    </table>
</div>
{% else %}
<div class="card-custom">
    <p>ğŸ“­ No hay citas programadas</p>
</div>
{% endif %}

<div class="d-flex gap-2 mt-4">
    <a href="{% url 'pedidos_home' %}" class="btn btn-secondary">â¬…ï¸ Volver a Inicio</a>
</div>

{% endblock %}