{% extends "base.html" %}
{% block contenido %}
<h2>Pedido #{{ pedido_id }}</h2>

<!-- DATOS DEL CLIENTE -->
<div class="card-custom mb-4">
    <h5 class="section-title mb-3">Datos del cliente</h5>
    <p><strong>Cliente:</strong> {{ pedido.Cliente }}</p>
    <p><strong>TelÃ©fono:</strong> {{ pedido.Telefono }}</p>
    <p><strong>Club:</strong> {{ pedido.Club }}</p>
</div>

<!-- FECHAS -->
<div class="card-custom mb-4">
    <h5 class="section-title mb-3">Fechas</h5>
    <p><strong>Fecha de entrada:</strong> {{ pedido.Fecha_entrada|default:"â€”" }}</p>
    <p><strong>Fecha estimada de entrega:</strong> {{ pedido.Fecha_entrega_estimada|default:"â€”" }}</p>
    <p><strong>Fecha de finalizaciÃ³n:</strong> {{ pedido.Fecha_finalizacion|default:"â€”" }}</p>
</div>

<!-- COMENTARIOS -->
<div class="card-custom mb-4">
    <h5 class="section-title mb-3">Comentarios</h5>
    <p>{{ pedido.Comentarios|default:"Sin comentarios" }}</p>
</div>

<!-- ESTADOS -->
<div class="card-custom mb-4">
    <h5 class="section-title mb-3">Estados</h5>
    {% if pedido.Estados %}
        {% for estado in pedido.Estados %}
            {% if estado == "trabajo iniciado" %}
                <span class="estado-pill">ğŸš§ {{ estado }}</span>
            {% elif estado == "Nuevo" %}
                <span class="estado-pill">ğŸŸ¢ {{ estado }}</span>
            {% elif estado == "diseÃ±o" %}
                <span class="estado-pill">ğŸ¨ {{ estado }}</span>
            {% elif estado == "fabricacion" %}
                <span class="estado-pill">ğŸ§µ {{ estado }}</span>
            {% elif estado == "trabajo terminado" %}
                <span class="estado-pill">âœ… {{ estado }}</span>
            {% elif estado == "cobrado" %}
                <span class="estado-pill">ğŸ’° {{ estado }}</span>
            {% elif estado == "retirado" %}
                <span class="estado-pill">ğŸšš {{ estado }}</span>
            {% elif estado == "pendiente" %}
                <span class="estado-pill">â³ {{ estado }}</span>
            {% else %}
                <span class="estado-pill">{{ estado }}</span>
            {% endif %}
        {% endfor %}
    {% else %}
        <p>â€”</p>
    {% endif %}
</div>

<!-- PRODUCTOS -->
<div class="card-custom mb-4">
    <h5 class="section-title mb-3">Productos</h5>
    {% if pedido.productos %}
        <table class="table-detail">
            <thead>
                <tr>
                    <th>Producto</th>
                    <th>Tejido</th>
                    <th>Cantidad</th>
                    <th>Precio unitario</th>
                    <th>Subtotal</th>
                </tr>
            </thead>
            <tbody>
                {% for p in pedido.productos %}
                <tr>
                    <td>{{ p.Producto|default:"â€”" }}</td>
                    <td>{{ p.tejido|default:"â€”" }}</td>
                    <td>{{ p.cantidad|floatformat:0 }}</td>
                    <td>{{ p.precio_unitario|floatformat:2 }} â‚¬</td>
                    <td>{{ p.subtotal|floatformat:2 }} â‚¬</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No hay productos en este pedido.</p>
    {% endif %}
</div>

<!-- FACTURACIÃ“N Y PAGO -->
<div class="card-custom mb-4">
    <h5 class="section-title mb-3">FacturaciÃ³n y pago</h5>
    <p><strong>Total del pedido:</strong> {{ pedido.total_pedido|floatformat:2 }} â‚¬</p>
    <p><strong>Precio factura:</strong> {{ pedido.Precio_factura|default:"0.00"|floatformat:2 }} â‚¬</p>
    <p><strong>Pago adelantado:</strong> {{ pedido.Pago_adelantado|default:"0.00"|floatformat:2 }} â‚¬</p>
    <p><strong>Forma de pago:</strong> 
        {% if pedido.Forma_pago %}
            {{ pedido.Forma_pago|title }}
        {% else %}
            â€”
        {% endif %}
    </p>
</div>

<!-- BOTONES DE ACCIÃ“N -->
<div class="d-flex gap-2">
    <a href="{% url 'pedido_editar' pedido_id %}" class="btn btn-primary">âœï¸ Editar</a>
    <a href="{% url 'pedido_eliminar' pedido_id %}" class="btn btn-danger">ğŸ—‘ï¸ Eliminar</a>
    <a href="/pedidos/" class="btn btn-secondary">â¬…ï¸ Volver</a>
</div>

{% endblock %}